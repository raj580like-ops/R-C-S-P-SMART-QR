<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>R-C-S-P Smart QR</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:,">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <!-- QR Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>

    <div id="initial-loader"><b>R-C-S-P</b></div>
    <div id="offline-indicator" class="hidden">‚ö†Ô∏è Offline Mode</div>

    <!-- MAIN HEADER -->
    <header id="main-header" class="hidden">
        <div class="header-container">
            <div class="logo">R-C-S-P <span>Smart QR</span></div>
            <button id="logout-btn" class="btn-icon">üö™</button>
        </div>
    </header>

    <!-- 1. LOGIN SCREEN -->
    <div id="login-screen" class="screen active">
        <div class="auth-wrapper">
            <div class="glass-card auth-card">
                <h1>Welcome Back</h1>
                <p>Sign in to manage your store</p>
                <form id="login-form">
                    <input type="email" id="login-email" placeholder="Admin Email" required>
                    <input type="password" id="login-pw" placeholder="Password" required>
                    <button type="submit" class="btn-primary">Sign In</button>
                </form>
            </div>
        </div>
    </div>

    <!-- 2. DASHBOARD -->
    <main id="dashboard" class="screen hidden">
        <div class="container">
            <div class="welcome-bar">
                <h2>Control Panel</h2>
                <p id="user-display">Logged in as Admin</p>
            </div>
            <div class="dashboard-grid">
                <div class="tile" onclick="showModule('generator-module')">
                    <div class="tile-icon">üè∑Ô∏è</div>
                    <h3>Add Product</h3>
                </div>
                <div class="tile" onclick="showModule('billing-module')">
                    <div class="tile-icon">üßæ</div>
                    <h3>New Bill</h3>
                </div>
                <div class="tile" onclick="showModule('scanner-module')">
                    <div class="tile-icon">üîç</div>
                    <h3>Price Check</h3>
                </div>
                <div class="tile" onclick="showModule('inventory-module')">
                    <div class="tile-icon">üì¶</div>
                    <h3>Inventory</h3>
                </div>
            </div>
        </div>
    </main>

    <!-- 3. INVENTORY MANAGEMENT -->
    <section id="inventory-module" class="screen hidden">
        <div class="container">
            <div class="module-nav">
                <button onclick="showModule('dashboard')" class="btn-back">‚Üê Dashboard</button>
                <h2>Inventory</h2>
            </div>
            <div class="search-bar">
                <span class="icon">üîç</span>
                <input type="text" id="inventory-search" placeholder="Search products..." oninput="filterInventory()">
            </div>
            <div id="inventory-list" class="glass-card list-container">
                <!-- Products load here -->
            </div>
        </div>
    </section>

    <!-- 4. PRICE CHECK (SCAN & SEARCH) -->
    <section id="scanner-module" class="screen hidden">
        <div class="container">
            <div class="module-nav">
                <button onclick="showModule('dashboard')" class="btn-back">‚Üê Dashboard</button>
                <h2>Price Lookup</h2>
            </div>
            <div class="search-bar">
                <span class="icon">üîé</span>
                <input type="text" id="lookup-search" placeholder="Type product name..." oninput="searchTextLookup()">
            </div>
            <div id="lookup-search-results" class="search-dropdown hidden"></div>

            <div class="divider"><span>OR USE CAMERA</span></div>
            
            <button class="btn-primary" onclick="startLookupScan()">üì∑ Open QR Scanner</button>
            <div id="reader-lookup" class="camera-box"></div>
            <div id="lookup-result" class="glass-card result-card hidden"></div>
        </div>
    </section>

    <!-- 5. QR GENERATOR -->
    <section id="generator-module" class="screen hidden">
        <div class="container">
            <div class="module-nav">
                <button onclick="showModule('dashboard')" class="btn-back">‚Üê Dashboard</button>
                <h2>Create Product</h2>
            </div>
            <form id="product-form" class="glass-card">
                <div class="input-group">
                    <label>Product Name</label>
                    <input type="text" id="p-name" placeholder="Enter Name" required>
                </div>
                <div class="form-row">
                    <div class="input-group">
                        <label>Buy Price</label>
                        <input type="number" id="p-buy" step="0.01" required>
                    </div>
                    <div class="input-group">
                        <label>Sell Price</label>
                        <input type="number" id="p-sell" step="0.01" required>
                    </div>
                </div>
                <div class="input-group">
                    <label>Initial Stock</label>
                    <input type="number" id="p-stock" required>
                </div>
                <div id="calc-preview" class="profit-banner">Profit: ‚Çπ0.00</div>
                <button type="submit" class="btn-primary">Save & Generate QR</button>
            </form>
            <div id="qr-result-container" class="glass-card hidden text-center">
                <div id="qrcode"></div>
                <button id="download-qr" class="btn-secondary">Download QR Image</button>
            </div>
        </div>
    </section>

    <!-- 6. BILLING SYSTEM -->
    <section id="billing-module" class="screen hidden">
        <div class="container">
            <div class="module-nav">
                <button onclick="showModule('dashboard')" class="btn-back">‚Üê Dashboard</button>
                <h2>Billing</h2>
            </div>
            <button class="btn-primary" onclick="startBillingScan()">üì∑ Scan to Add</button>
            <div id="reader-billing" class="camera-box"></div>
            
            <div class="glass-card cart-container">
                <table id="cart-table">
                    <thead><tr><th>Item</th><th>Qty</th><th>Total</th></tr></thead>
                    <tbody></tbody>
                </table>
                <div class="cart-total">
                    <span>Total</span>
                    <span id="bill-total">‚Çπ0.00</span>
                </div>
                <input type="text" id="cust-name" placeholder="Customer Name (Optional)">
                <button id="checkout-btn" class="btn-success">Print Invoice</button>
            </div>
        </div>
    </section>

    <div id="invoice-print-area" class="print-only"></div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
